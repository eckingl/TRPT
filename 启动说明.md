# 农业土壤普查报告生成系统 - 启动说明

## 📦 一键启动脚本说明

项目提供了 4 个批处理脚本，方便快速启动和管理系统。

---

## 🚀 启动脚本

### 1️⃣ `启动系统.bat` - **生产模式启动（推荐）**

**适用场景**: 日常使用、生产环境

**功能**:
- ✅ 自动检查 Python 环境
- ✅ 自动检查和安装后端依赖
- ✅ 检测端口占用并提供解决方案
- ✅ 启动后端服务
- ✅ 1.5 秒后自动打开浏览器
- ✅ 前端已打包为静态文件（由后端服务）

**访问地址**: http://127.0.0.1:8000

**使用方法**:
```bash
双击运行 启动系统.bat
```

---

### 2️⃣ `启动系统-开发模式.bat` - **开发模式启动**

**适用场景**: 前端开发、功能调试

**功能**:
- ✅ 自动检查 Python 和 Node.js 环境
- ✅ 自动安装前后端依赖
- ✅ 同时启动前端和后端服务
- ✅ 前端热重载（修改代码自动刷新）
- ✅ 后端热重载（修改代码自动重启）

**访问地址**:
- 前端: http://localhost:5173 (推荐)
- 后端: http://127.0.0.1:8000

**使用方法**:
```bash
双击运行 启动系统-开发模式.bat
```

**注意**:
- 首次运行会安装 node_modules（约 129MB），需要较长时间
- 前端自动代理 `/api` 请求到后端

---

### 3️⃣ `停止服务.bat` - **停止所有服务**

**适用场景**: 服务异常、需要重启、关闭系统

**功能**:
- ✅ 检测并停止后端服务（端口 8000）
- ✅ 检测并停止前端服务（端口 5173）
- ✅ 清理相关进程

**使用方法**:
```bash
双击运行 停止服务.bat
```

---

### 4️⃣ `系统诊断.bat` - **环境诊断工具**

**适用场景**: 启动失败、排查问题、首次安装

**功能**:
- ✅ 检查 Python 环境
- ✅ 检查 Node.js 环境
- ✅ 检查后端依赖（FastAPI、Uvicorn、Pandas 等）
- ✅ 检查前端依赖（node_modules）
- ✅ 检查端口占用情况
- ✅ 检查数据库文件
- ✅ 检查目录结构完整性

**使用方法**:
```bash
双击运行 系统诊断.bat
```

**输出示例**:
```
[1/7] 检查 Python 环境
----------------------------------------
Python 3.11.5
✓ Python 已安装

[2/7] 检查 Node.js 环境
----------------------------------------
v18.16.0
✓ Node.js 已安装
```

---

## 🛠️ 常见问题解决

### 问题 1: 提示 "Python 未安装"
**解决方法**:
1. 下载 Python 3.11+: https://www.python.org/downloads/
2. 安装时勾选 "Add Python to PATH"
3. 重启命令提示符

---

### 问题 2: 提示 "端口已被占用"
**解决方法**:
- **方式 1**: 运行 `停止服务.bat`
- **方式 2**: 在 `启动系统.bat` 中选择 "结束占用进程"

---

### 问题 3: 前端依赖安装失败
**解决方法**:
```bash
# 手动安装
cd frontend
npm install

# 或使用淘宝镜像
npm install --registry=https://registry.npmmirror.com
```

---

### 问题 4: 后端依赖安装失败
**解决方法**:
```bash
# 手动安装
cd backend
pip install -r requirements.txt

# 或使用清华镜像
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

---

## 📋 快速启动流程

### 首次使用
1. 运行 `系统诊断.bat` 检查环境
2. 如有缺失，安装 Python 和 Node.js
3. 运行 `启动系统.bat` 启动系统

### 日常使用
- 双击 `启动系统.bat` 即可

### 开发调试
- 双击 `启动系统-开发模式.bat`

### 停止服务
- 双击 `停止服务.bat`

---

## 🎯 启动模式对比

| 特性 | 生产模式 | 开发模式 |
|------|---------|---------|
| 启动脚本 | `启动系统.bat` | `启动系统-开发模式.bat` |
| 前端服务 | 静态文件（FastAPI 托管） | Vite Dev Server |
| 后端服务 | Uvicorn | Uvicorn (reload) |
| 访问地址 | http://127.0.0.1:8000 | http://localhost:5173 |
| 热重载 | ❌ | ✅ |
| 需要 Node.js | ❌ | ✅ |
| 启动速度 | 快 | 慢 |
| 适用场景 | 日常使用 | 开发调试 |

---

## 📦 系统要求

### 必需
- **Python**: 3.11 或更高
- **操作系统**: Windows 10/11

### 可选（开发模式）
- **Node.js**: 18.x 或更高
- **npm**: 9.x 或更高

---

## 🔧 手动启动（高级用户）

如果不想使用批处理脚本，也可以手动启动：

### 生产模式
```bash
python main.py
```

### 开发模式 - 后端
```bash
cd backend
python -m uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
```

### 开发模式 - 前端
```bash
cd frontend
npm run dev
```

---

## 📞 技术支持

如遇到问题，请检查：
1. 运行 `系统诊断.bat` 查看详细信息
2. 查看控制台错误信息
3. 检查 `backend/app/config.py` 配置
4. 确认防火墙未阻止端口 8000 和 5173

---

**版本**: 0.1.0
**最后更新**: 2025-12-06
